INFO	__main__	Sun, 06 Aug 2023 11:17:05	Writing config to flat_res/ARBERTv2_MTN_CE_VAR_lr2e-5/args.json
INFO	arabiner.utils.data	Sun, 06 Aug 2023 11:17:06	1052 batches found
INFO	arabiner.utils.data	Sun, 06 Aug 2023 11:17:06	196 batches found
INFO	arabiner.utils.data	Sun, 06 Aug 2023 11:17:06	375 batches found
INFO	torch.distributed.nn.jit.instantiator	Sun, 06 Aug 2023 11:17:07	Created a temporary directory at /tmp/tmplhbarkls
INFO	torch.distributed.nn.jit.instantiator	Sun, 06 Aug 2023 11:17:07	Writing /tmp/tmplhbarkls/_remote_module_non_scriptable.py
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:19:26	Epoch 0 | Batch 1052/1052 | Timestep 1052 | LR 0.0000186667 | Loss 0.059208
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:19:26	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:19:40	
              precision    recall  f1-score   support

    CARDINAL     0.8629    0.8297    0.8459       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9401    0.9515    0.9458      1567
       EVENT     0.7269    0.7154    0.7211       253
         FAC     0.5865    0.7176    0.6455        85
         GPE     0.8621    0.9002    0.8807      1132
    LANGUAGE     0.6500    0.8667    0.7429        15
         LAW     0.6250    0.9091    0.7407        44
         LOC     0.5500    0.5238    0.5366        63
       MONEY     0.7917    0.9500    0.8636        20
        NORP     0.6284    0.7520    0.6847       488
         OCC     0.8031    0.8474    0.8247       544
     ORDINAL     0.9201    0.9268    0.9235       410
         ORG     0.8991    0.8934    0.8962      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9202    0.9400    0.9300       650
     PRODUCT     0.0000    0.0000    0.0000         5
    QUANTITY     0.5000    0.3333    0.4000         3
        TIME     0.7143    0.6364    0.6731        55
     WEBSITE     0.3191    0.6667    0.4317        45

   micro avg     0.8505    0.8829    0.8664      7141
   macro avg     0.6650    0.7180    0.6843      7141
weighted avg     0.8574    0.8829    0.8689      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:19:41	Epoch 0 | Timestep 1052 | Train Loss 0.377980 | Val Loss 0.065262 | F1 0.866428
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:19:41	** Validation improved, evaluating test data **
INFO	root	Sun, 06 Aug 2023 11:20:09	Predictions written to flat_res/ARBERTv2_MTN_CE_VAR_lr2e-5/predictions.txt
INFO	root	Sun, 06 Aug 2023 11:20:10	
              precision    recall  f1-score   support

    CARDINAL     0.0000    0.0000    0.0000         0
        DATE     0.0000    0.0000    0.0000         0
       EVENT     0.0000    0.0000    0.0000         0
         FAC     0.0000    0.0000    0.0000         0
         GPE     0.0000    0.0000    0.0000         0
    LANGUAGE     0.0000    0.0000    0.0000         0
         LAW     0.0000    0.0000    0.0000         0
         LOC     0.0000    0.0000    0.0000         0
       MONEY     0.0000    0.0000    0.0000         0
        NORP     0.0000    0.0000    0.0000         0
         OCC     0.0000    0.0000    0.0000         0
     ORDINAL     0.0000    0.0000    0.0000         0
         ORG     0.0000    0.0000    0.0000         0
     PERCENT     0.0000    0.0000    0.0000         0
        PERS     0.0000    0.0000    0.0000         0
     PRODUCT     0.0000    0.0000    0.0000         0
    QUANTITY     0.0000    0.0000    0.0000         0
        TIME     0.0000    0.0000    0.0000         0
     WEBSITE     0.0000    0.0000    0.0000         0

   micro avg     0.0000    0.0000    0.0000         0
   macro avg     0.0000    0.0000    0.0000         0
weighted avg     0.0000    0.0000    0.0000         0

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:20:12	Epoch 0 | Timestep 1052 | Test Loss 1.266594 | F1 0.000000
INFO	arabiner.trainers.BaseTrainer	Sun, 06 Aug 2023 11:20:12	Saving checkpoint to flat_res/ARBERTv2_MTN_CE_VAR_lr2e-5/checkpoints/checkpoint_0.pt
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:22:34	Epoch 1 | Batch 1052/1052 | Timestep 2104 | LR 0.0000173333 | Loss 0.217138
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:22:34	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:22:48	
              precision    recall  f1-score   support

    CARDINAL     0.8827    0.8681    0.8753       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9203    0.9579    0.9387      1567
       EVENT     0.6928    0.8024    0.7436       253
         FAC     0.6040    0.7176    0.6559        85
         GPE     0.8651    0.9011    0.8827      1132
    LANGUAGE     0.7368    0.9333    0.8235        15
         LAW     0.9048    0.8636    0.8837        44
         LOC     0.6324    0.6825    0.6565        63
       MONEY     0.9048    0.9500    0.9268        20
        NORP     0.6100    0.7787    0.6841       488
         OCC     0.8325    0.8768    0.8541       544
     ORDINAL     0.9118    0.9585    0.9346       410
         ORG     0.9208    0.8985    0.9095      1566
     PERCENT     0.9286    1.0000    0.9630        13
        PERS     0.9447    0.9462    0.9454       650
     PRODUCT     0.3333    0.2000    0.2500         5
    QUANTITY     0.6667    0.6667    0.6667         3
        TIME     0.6212    0.7455    0.6777        55
     WEBSITE     0.4889    0.4889    0.4889        45

   micro avg     0.8578    0.8974    0.8771      7141
   macro avg     0.7201    0.7618    0.7380      7141
weighted avg     0.8640    0.8974    0.8794      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:22:49	Epoch 1 | Timestep 2104 | Train Loss 0.042130 | Val Loss 0.057428 | F1 0.877147
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:22:49	** Validation improved, evaluating test data **
INFO	root	Sun, 06 Aug 2023 11:23:17	Predictions written to flat_res/ARBERTv2_MTN_CE_VAR_lr2e-5/predictions.txt
INFO	root	Sun, 06 Aug 2023 11:23:18	
              precision    recall  f1-score   support

    CARDINAL     0.0000    0.0000    0.0000         0
        DATE     0.0000    0.0000    0.0000         0
       EVENT     0.0000    0.0000    0.0000         0
         FAC     0.0000    0.0000    0.0000         0
         GPE     0.0000    0.0000    0.0000         0
    LANGUAGE     0.0000    0.0000    0.0000         0
         LAW     0.0000    0.0000    0.0000         0
         LOC     0.0000    0.0000    0.0000         0
       MONEY     0.0000    0.0000    0.0000         0
        NORP     0.0000    0.0000    0.0000         0
         OCC     0.0000    0.0000    0.0000         0
     ORDINAL     0.0000    0.0000    0.0000         0
         ORG     0.0000    0.0000    0.0000         0
     PERCENT     0.0000    0.0000    0.0000         0
        PERS     0.0000    0.0000    0.0000         0
     PRODUCT     0.0000    0.0000    0.0000         0
    QUANTITY     0.0000    0.0000    0.0000         0
        TIME     0.0000    0.0000    0.0000         0
     WEBSITE     0.0000    0.0000    0.0000         0

   micro avg     0.0000    0.0000    0.0000         0
   macro avg     0.0000    0.0000    0.0000         0
weighted avg     0.0000    0.0000    0.0000         0

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:23:19	Epoch 1 | Timestep 2104 | Test Loss 1.564256 | F1 0.000000
INFO	arabiner.trainers.BaseTrainer	Sun, 06 Aug 2023 11:23:19	Saving checkpoint to flat_res/ARBERTv2_MTN_CE_VAR_lr2e-5/checkpoints/checkpoint_1.pt
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:25:41	Epoch 2 | Batch 1052/1052 | Timestep 3156 | LR 0.0000160000 | Loss 0.013033
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:25:41	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:25:56	
              precision    recall  f1-score   support

    CARDINAL     0.8670    0.8956    0.8811       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9392    0.9458    0.9424      1567
       EVENT     0.7250    0.8024    0.7617       253
         FAC     0.6383    0.7059    0.6704        85
         GPE     0.8896    0.8825    0.8860      1132
    LANGUAGE     0.7778    0.9333    0.8485        15
         LAW     0.6964    0.8864    0.7800        44
         LOC     0.7667    0.7302    0.7480        63
       MONEY     0.9048    0.9500    0.9268        20
        NORP     0.6813    0.7623    0.7195       488
         OCC     0.8618    0.8824    0.8719       544
     ORDINAL     0.9400    0.9561    0.9480       410
         ORG     0.8808    0.9246    0.9022      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9131    0.9538    0.9330       650
     PRODUCT     0.1429    0.2000    0.1667         5
    QUANTITY     0.6667    0.6667    0.6667         3
        TIME     0.7593    0.7455    0.7523        55
     WEBSITE     0.5667    0.3778    0.4533        45

   micro avg     0.8701    0.8978    0.8837      7141
   macro avg     0.7309    0.7601    0.7429      7141
weighted avg     0.8718    0.8978    0.8841      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:25:57	Epoch 2 | Timestep 3156 | Train Loss 0.027304 | Val Loss 0.059900 | F1 0.883727
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:28:12	Epoch 3 | Batch 1052/1052 | Timestep 4208 | LR 0.0000146667 | Loss 0.005852
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:28:12	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:28:27	
              precision    recall  f1-score   support

    CARDINAL     0.8290    0.8791    0.8533       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9491    0.9528    0.9510      1567
       EVENT     0.5926    0.8221    0.6887       253
         FAC     0.6321    0.7882    0.7016        85
         GPE     0.8746    0.9055    0.8898      1132
    LANGUAGE     0.7895    1.0000    0.8824        15
         LAW     0.8333    0.9091    0.8696        44
         LOC     0.7164    0.7619    0.7385        63
       MONEY     0.8421    0.8000    0.8205        20
        NORP     0.6836    0.7705    0.7245       488
         OCC     0.8448    0.9007    0.8719       544
     ORDINAL     0.9161    0.9585    0.9368       410
         ORG     0.9216    0.9080    0.9148      1566
     PERCENT     0.9286    1.0000    0.9630        13
        PERS     0.9263    0.9662    0.9458       650
     PRODUCT     0.2222    0.4000    0.2857         5
    QUANTITY     1.0000    1.0000    1.0000         3
        TIME     0.7193    0.7455    0.7321        55
     WEBSITE     0.5641    0.4889    0.5238        45

   micro avg     0.8673    0.9049    0.8857      7141
   macro avg     0.7393    0.7979    0.7647      7141
weighted avg     0.8735    0.9049    0.8880      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:28:28	Epoch 3 | Timestep 4208 | Train Loss 0.017787 | Val Loss 0.062504 | F1 0.885691
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:30:42	Epoch 4 | Batch 1052/1052 | Timestep 5260 | LR 0.0000133333 | Loss 0.009033
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:30:42	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:30:58	
              precision    recall  f1-score   support

    CARDINAL     0.8265    0.8901    0.8571       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9281    0.9477    0.9378      1567
       EVENT     0.6952    0.8024    0.7450       253
         FAC     0.5234    0.7882    0.6291        85
         GPE     0.9068    0.8852    0.8958      1132
    LANGUAGE     0.8333    1.0000    0.9091        15
         LAW     0.7736    0.9318    0.8454        44
         LOC     0.7812    0.7937    0.7874        63
       MONEY     0.7826    0.9000    0.8372        20
        NORP     0.6436    0.7992    0.7130       488
         OCC     0.8448    0.9007    0.8719       544
     ORDINAL     0.9412    0.9366    0.9389       410
         ORG     0.8965    0.9349    0.9153      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9242    0.9569    0.9403       650
     PRODUCT     0.3750    0.6000    0.4615         5
    QUANTITY     0.7500    1.0000    0.8571         3
        TIME     0.6875    0.8000    0.7395        55
     WEBSITE     0.5294    0.6000    0.5625        45

   micro avg     0.8619    0.9079    0.8843      7141
   macro avg     0.7322    0.8234    0.7722      7141
weighted avg     0.8691    0.9079    0.8870      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:30:58	Epoch 4 | Timestep 5260 | Train Loss 0.013533 | Val Loss 0.067501 | F1 0.884267
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:33:14	Epoch 5 | Batch 1052/1052 | Timestep 6312 | LR 0.0000120000 | Loss 0.003091
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:33:14	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:33:28	
              precision    recall  f1-score   support

    CARDINAL     0.8594    0.9066    0.8824       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9509    0.9509    0.9509      1567
       EVENT     0.8182    0.7826    0.8000       253
         FAC     0.6526    0.7294    0.6889        85
         GPE     0.8935    0.9267    0.9098      1132
    LANGUAGE     0.7895    1.0000    0.8824        15
         LAW     0.7455    0.9318    0.8283        44
         LOC     0.7231    0.7460    0.7344        63
       MONEY     0.9000    0.9000    0.9000        20
        NORP     0.7271    0.7480    0.7374       488
         OCC     0.8795    0.8989    0.8891       544
     ORDINAL     0.9398    0.9512    0.9455       410
         ORG     0.9239    0.9221    0.9230      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9356    0.9615    0.9484       650
     PRODUCT     0.2857    0.4000    0.3333         5
    QUANTITY     1.0000    1.0000    1.0000         3
        TIME     0.8043    0.6727    0.7327        55
     WEBSITE     0.6364    0.6222    0.6292        45

   micro avg     0.8942    0.9076    0.9008      7141
   macro avg     0.7732    0.8025    0.7858      7141
weighted avg     0.8952    0.9076    0.9011      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:33:29	Epoch 5 | Timestep 6312 | Train Loss 0.009393 | Val Loss 0.068974 | F1 0.900827
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:35:45	Epoch 6 | Batch 1052/1052 | Timestep 7364 | LR 0.0000106667 | Loss 0.008396
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:35:45	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:35:59	
              precision    recall  f1-score   support

    CARDINAL     0.8370    0.8462    0.8415       182
        CURR     1.0000    1.0000    1.0000         1
        DATE     0.9397    0.9541    0.9468      1567
       EVENT     0.7399    0.7984    0.7681       253
         FAC     0.6000    0.7412    0.6632        85
         GPE     0.8900    0.9223    0.9059      1132
    LANGUAGE     0.8333    1.0000    0.9091        15
         LAW     0.8039    0.9318    0.8632        44
         LOC     0.7143    0.7937    0.7519        63
       MONEY     0.9048    0.9500    0.9268        20
        NORP     0.7079    0.7746    0.7397       488
         OCC     0.8640    0.8879    0.8758       544
     ORDINAL     0.9269    0.9585    0.9424       410
         ORG     0.9118    0.9240    0.9179      1566
     PERCENT     0.9286    1.0000    0.9630        13
        PERS     0.9402    0.9677    0.9538       650
     PRODUCT     0.4000    0.4000    0.4000         5
    QUANTITY     0.7500    1.0000    0.8571         3
        TIME     0.7288    0.7818    0.7544        55
     WEBSITE     0.5510    0.6000    0.5745        45

   micro avg     0.8797    0.9105    0.8949      7141
   macro avg     0.7986    0.8616    0.8277      7141
weighted avg     0.8820    0.9105    0.8958      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:36:00	Epoch 6 | Timestep 7364 | Train Loss 0.008108 | Val Loss 0.073380 | F1 0.894853
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:36:00	Early termination triggered
