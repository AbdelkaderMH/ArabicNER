INFO	__main__	Sun, 06 Aug 2023 10:50:42	Writing config to flat_res/ARBERTv2_MTN_CE_lr2e-5/args.json
INFO	arabiner.utils.data	Sun, 06 Aug 2023 10:50:43	1052 batches found
INFO	arabiner.utils.data	Sun, 06 Aug 2023 10:50:43	196 batches found
INFO	arabiner.utils.data	Sun, 06 Aug 2023 10:50:43	375 batches found
INFO	torch.distributed.nn.jit.instantiator	Sun, 06 Aug 2023 10:50:44	Created a temporary directory at /tmp/tmp56krtv15
INFO	torch.distributed.nn.jit.instantiator	Sun, 06 Aug 2023 10:50:44	Writing /tmp/tmp56krtv15/_remote_module_non_scriptable.py
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:53:03	Epoch 0 | Batch 1052/1052 | Timestep 1052 | LR 0.0000186667 | Loss 0.051052
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:53:03	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 10:53:18	
              precision    recall  f1-score   support

    CARDINAL     0.8596    0.8407    0.8500       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9325    0.9432    0.9378      1567
       EVENT     0.7309    0.7194    0.7251       253
         FAC     0.5825    0.7059    0.6383        85
         GPE     0.8625    0.8869    0.8746      1132
    LANGUAGE     0.6500    0.8667    0.7429        15
         LAW     0.6349    0.9091    0.7477        44
         LOC     0.6429    0.5714    0.6050        63
       MONEY     0.7917    0.9500    0.8636        20
        NORP     0.6083    0.7541    0.6734       488
         OCC     0.8078    0.8419    0.8245       544
     ORDINAL     0.9214    0.9146    0.9180       410
         ORG     0.8917    0.8934    0.8925      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9271    0.9385    0.9327       650
     PRODUCT     0.0000    0.0000    0.0000         5
    QUANTITY     0.5000    0.3333    0.4000         3
        TIME     0.5714    0.5818    0.5766        55
     WEBSITE     0.3469    0.7556    0.4755        45

   micro avg     0.8460    0.8787    0.8621      7141
   macro avg     0.6631    0.7203    0.6839      7141
weighted avg     0.8538    0.8787    0.8649      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:53:19	Epoch 0 | Timestep 1052 | Train Loss 0.375249 | Val Loss 0.064747 | F1 0.862069
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:53:19	** Validation improved, evaluating test data **
INFO	root	Sun, 06 Aug 2023 10:53:48	Predictions written to flat_res/ARBERTv2_MTN_CE_lr2e-5/predictions.txt
INFO	root	Sun, 06 Aug 2023 10:53:49	
              precision    recall  f1-score   support

    CARDINAL     0.0000    0.0000    0.0000         0
        DATE     0.0000    0.0000    0.0000         0
       EVENT     0.0000    0.0000    0.0000         0
         FAC     0.0000    0.0000    0.0000         0
         GPE     0.0000    0.0000    0.0000         0
    LANGUAGE     0.0000    0.0000    0.0000         0
         LAW     0.0000    0.0000    0.0000         0
         LOC     0.0000    0.0000    0.0000         0
       MONEY     0.0000    0.0000    0.0000         0
        NORP     0.0000    0.0000    0.0000         0
         OCC     0.0000    0.0000    0.0000         0
     ORDINAL     0.0000    0.0000    0.0000         0
         ORG     0.0000    0.0000    0.0000         0
     PERCENT     0.0000    0.0000    0.0000         0
        PERS     0.0000    0.0000    0.0000         0
     PRODUCT     0.0000    0.0000    0.0000         0
    QUANTITY     0.0000    0.0000    0.0000         0
        TIME     0.0000    0.0000    0.0000         0
     WEBSITE     0.0000    0.0000    0.0000         0

   micro avg     0.0000    0.0000    0.0000         0
   macro avg     0.0000    0.0000    0.0000         0
weighted avg     0.0000    0.0000    0.0000         0

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:53:50	Epoch 0 | Timestep 1052 | Test Loss 1.040645 | F1 0.000000
INFO	arabiner.trainers.BaseTrainer	Sun, 06 Aug 2023 10:53:50	Saving checkpoint to flat_res/ARBERTv2_MTN_CE_lr2e-5/checkpoints/checkpoint_0.pt
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:56:12	Epoch 1 | Batch 1052/1052 | Timestep 2104 | LR 0.0000173333 | Loss 0.141996
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:56:12	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 10:56:27	
              precision    recall  f1-score   support

    CARDINAL     0.8947    0.8407    0.8669       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9129    0.9560    0.9339      1567
       EVENT     0.7050    0.7747    0.7382       253
         FAC     0.6139    0.7294    0.6667        85
         GPE     0.8634    0.8825    0.8729      1132
    LANGUAGE     0.7500    0.8000    0.7742        15
         LAW     0.9512    0.8864    0.9176        44
         LOC     0.7368    0.6667    0.7000        63
       MONEY     0.9500    0.9500    0.9500        20
        NORP     0.6275    0.7869    0.6982       488
         OCC     0.8278    0.8750    0.8508       544
     ORDINAL     0.8891    0.9585    0.9225       410
         ORG     0.9224    0.8959    0.9090      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9367    0.9338    0.9353       650
     PRODUCT     0.3333    0.2000    0.2500         5
    QUANTITY     1.0000    0.6667    0.8000         3
        TIME     0.6119    0.7455    0.6721        55
     WEBSITE     0.5750    0.5111    0.5412        45

   micro avg     0.8593    0.8911    0.8749      7141
   macro avg     0.7551    0.7530    0.7500      7141
weighted avg     0.8642    0.8911    0.8765      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:56:28	Epoch 1 | Timestep 2104 | Train Loss 0.042301 | Val Loss 0.057723 | F1 0.874880
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:56:28	** Validation improved, evaluating test data **
INFO	root	Sun, 06 Aug 2023 10:56:56	Predictions written to flat_res/ARBERTv2_MTN_CE_lr2e-5/predictions.txt
INFO	root	Sun, 06 Aug 2023 10:56:57	
              precision    recall  f1-score   support

    CARDINAL     0.0000    0.0000    0.0000         0
        DATE     0.0000    0.0000    0.0000         0
       EVENT     0.0000    0.0000    0.0000         0
         FAC     0.0000    0.0000    0.0000         0
         GPE     0.0000    0.0000    0.0000         0
    LANGUAGE     0.0000    0.0000    0.0000         0
         LAW     0.0000    0.0000    0.0000         0
         LOC     0.0000    0.0000    0.0000         0
       MONEY     0.0000    0.0000    0.0000         0
        NORP     0.0000    0.0000    0.0000         0
         OCC     0.0000    0.0000    0.0000         0
     ORDINAL     0.0000    0.0000    0.0000         0
         ORG     0.0000    0.0000    0.0000         0
     PERCENT     0.0000    0.0000    0.0000         0
        PERS     0.0000    0.0000    0.0000         0
     PRODUCT     0.0000    0.0000    0.0000         0
    QUANTITY     0.0000    0.0000    0.0000         0
        TIME     0.0000    0.0000    0.0000         0
     WEBSITE     0.0000    0.0000    0.0000         0

   micro avg     0.0000    0.0000    0.0000         0
   macro avg     0.0000    0.0000    0.0000         0
weighted avg     0.0000    0.0000    0.0000         0

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:56:58	Epoch 1 | Timestep 2104 | Test Loss 1.199858 | F1 0.000000
INFO	arabiner.trainers.BaseTrainer	Sun, 06 Aug 2023 10:56:58	Saving checkpoint to flat_res/ARBERTv2_MTN_CE_lr2e-5/checkpoints/checkpoint_1.pt
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:59:19	Epoch 2 | Batch 1052/1052 | Timestep 3156 | LR 0.0000160000 | Loss 0.029681
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:59:19	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 10:59:34	
              precision    recall  f1-score   support

    CARDINAL     0.8684    0.9066    0.8871       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9350    0.9451    0.9400      1567
       EVENT     0.6873    0.7905    0.7353       253
         FAC     0.6531    0.7529    0.6995        85
         GPE     0.9038    0.8719    0.8876      1132
    LANGUAGE     0.8125    0.8667    0.8387        15
         LAW     0.7843    0.9091    0.8421        44
         LOC     0.7143    0.7143    0.7143        63
       MONEY     0.9000    0.9000    0.9000        20
        NORP     0.7085    0.7520    0.7296       488
         OCC     0.8723    0.8787    0.8755       544
     ORDINAL     0.9398    0.9512    0.9455       410
         ORG     0.8797    0.9336    0.9058      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9208    0.9662    0.9429       650
     PRODUCT     0.4000    0.4000    0.4000         5
    QUANTITY     1.0000    0.6667    0.8000         3
        TIME     0.7193    0.7455    0.7321        55
     WEBSITE     0.6562    0.4667    0.5455        45

   micro avg     0.8744    0.8986    0.8863      7141
   macro avg     0.7678    0.7709    0.7661      7141
weighted avg     0.8758    0.8986    0.8866      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 10:59:35	Epoch 2 | Timestep 3156 | Train Loss 0.027248 | Val Loss 0.060112 | F1 0.886326
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:01:50	Epoch 3 | Batch 1052/1052 | Timestep 4208 | LR 0.0000146667 | Loss 0.012009
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:01:50	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:02:05	
              precision    recall  f1-score   support

    CARDINAL     0.8513    0.9121    0.8806       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9480    0.9547    0.9514      1567
       EVENT     0.6071    0.8063    0.6927       253
         FAC     0.7079    0.7412    0.7241        85
         GPE     0.8723    0.9108    0.8911      1132
    LANGUAGE     0.8000    0.8000    0.8000        15
         LAW     0.8125    0.8864    0.8478        44
         LOC     0.8246    0.7460    0.7833        63
       MONEY     0.9048    0.9500    0.9268        20
        NORP     0.6602    0.7684    0.7102       488
         OCC     0.8482    0.8934    0.8702       544
     ORDINAL     0.9265    0.9537    0.9399       410
         ORG     0.9208    0.8985    0.9095      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9190    0.9600    0.9391       650
     PRODUCT     0.2500    0.4000    0.3077         5
    QUANTITY     1.0000    1.0000    1.0000         3
        TIME     0.7193    0.7455    0.7321        55
     WEBSITE     0.6333    0.4222    0.5067        45

   micro avg     0.8695    0.9016    0.8853      7141
   macro avg     0.7603    0.7875    0.7707      7141
weighted avg     0.8749    0.9016    0.8870      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:02:06	Epoch 3 | Timestep 4208 | Train Loss 0.017756 | Val Loss 0.061730 | F1 0.885253
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:04:20	Epoch 4 | Batch 1052/1052 | Timestep 5260 | LR 0.0000133333 | Loss 0.005286
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:04:20	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:04:36	
              precision    recall  f1-score   support

    CARDINAL     0.8351    0.8901    0.8617       182
        CURR     0.0000    0.0000    0.0000         1
        DATE     0.9376    0.9489    0.9432      1567
       EVENT     0.7289    0.8182    0.7709       253
         FAC     0.5941    0.7059    0.6452        85
         GPE     0.9064    0.8896    0.8979      1132
    LANGUAGE     0.7895    1.0000    0.8824        15
         LAW     0.7407    0.9091    0.8163        44
         LOC     0.7419    0.7302    0.7360        63
       MONEY     0.8571    0.9000    0.8780        20
        NORP     0.7013    0.7889    0.7425       488
         OCC     0.8649    0.8824    0.8735       544
     ORDINAL     0.9666    0.9171    0.9412       410
         ORG     0.9047    0.9272    0.9158      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9216    0.9585    0.9397       650
     PRODUCT     0.2857    0.4000    0.3333         5
    QUANTITY     0.6667    0.6667    0.6667         3
        TIME     0.7368    0.7636    0.7500        55
     WEBSITE     0.5946    0.4889    0.5366        45

   micro avg     0.8790    0.9017    0.8902      7141
   macro avg     0.7387    0.7793    0.7565      7141
weighted avg     0.8821    0.9017    0.8913      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:04:36	Epoch 4 | Timestep 5260 | Train Loss 0.013263 | Val Loss 0.067740 | F1 0.890225
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:06:51	Epoch 5 | Batch 1052/1052 | Timestep 6312 | LR 0.0000120000 | Loss 0.002629
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:06:51	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:07:06	
              precision    recall  f1-score   support

    CARDINAL     0.8333    0.8516    0.8424       182
        CURR     1.0000    1.0000    1.0000         1
        DATE     0.9394    0.9502    0.9448      1567
       EVENT     0.7782    0.8182    0.7977       253
         FAC     0.6105    0.6824    0.6444        85
         GPE     0.8872    0.9099    0.8984      1132
    LANGUAGE     0.8333    1.0000    0.9091        15
         LAW     0.7273    0.9091    0.8081        44
         LOC     0.7302    0.7302    0.7302        63
       MONEY     0.9500    0.9500    0.9500        20
        NORP     0.7329    0.7705    0.7512       488
         OCC     0.8531    0.8971    0.8746       544
     ORDINAL     0.9087    0.9463    0.9271       410
         ORG     0.9136    0.9246    0.9191      1566
     PERCENT     1.0000    1.0000    1.0000        13
        PERS     0.9269    0.9554    0.9409       650
     PRODUCT     0.3000    0.6000    0.4000         5
    QUANTITY     1.0000    1.0000    1.0000         3
        TIME     0.7843    0.7273    0.7547        55
     WEBSITE     0.6250    0.6667    0.6452        45

   micro avg     0.8812    0.9060    0.8935      7141
   macro avg     0.8167    0.8645    0.8369      7141
weighted avg     0.8827    0.9060    0.8941      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:07:07	Epoch 5 | Timestep 6312 | Train Loss 0.009603 | Val Loss 0.069538 | F1 0.893461
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:09:22	Epoch 6 | Batch 1052/1052 | Timestep 7364 | LR 0.0000106667 | Loss 0.003408
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:09:22	** Evaluating on validation dataset **
INFO	root	Sun, 06 Aug 2023 11:09:37	
              precision    recall  f1-score   support

    CARDINAL     0.8526    0.8901    0.8710       182
        CURR     1.0000    1.0000    1.0000         1
        DATE     0.9426    0.9534    0.9480      1567
       EVENT     0.7537    0.8103    0.7810       253
         FAC     0.5963    0.7647    0.6701        85
         GPE     0.8927    0.9037    0.8982      1132
    LANGUAGE     0.8235    0.9333    0.8750        15
         LAW     0.7843    0.9091    0.8421        44
         LOC     0.7143    0.7937    0.7519        63
       MONEY     0.9000    0.9000    0.9000        20
        NORP     0.7460    0.7643    0.7551       488
         OCC     0.8627    0.8897    0.8760       544
     ORDINAL     0.9227    0.9610    0.9415       410
         ORG     0.9171    0.9253    0.9212      1566
     PERCENT     0.8667    1.0000    0.9286        13
        PERS     0.9260    0.9631    0.9442       650
     PRODUCT     0.5000    0.6000    0.5455         5
    QUANTITY     1.0000    1.0000    1.0000         3
        TIME     0.7288    0.7818    0.7544        55
     WEBSITE     0.5532    0.5778    0.5652        45

   micro avg     0.8843    0.9083    0.8961      7141
   macro avg     0.8142    0.8661    0.8384      7141
weighted avg     0.8859    0.9083    0.8968      7141

INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:09:38	Epoch 6 | Timestep 7364 | Train Loss 0.007737 | Val Loss 0.074980 | F1 0.896104
INFO	arabiner.trainers.BertMTNTrainer	Sun, 06 Aug 2023 11:09:38	Early termination triggered
